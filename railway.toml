[build]
  builder = "NIXPACKS"

[build.nixpacksSettings]
  # Install Playwright browsers and system dependencies during build
  cmds = [
    "python -m playwright install --with-deps chromium"
  ]

[deploy]
  # Set environment variables for Playwright
  # PLAYWRIGHT_BROWSERS_PATH is set to use Railway's persistent storage
  # Railway expands $PORT when using railway.toml startCommand
  startCommand = "uvicorn app.main:app --host 0.0.0.0 --port $PORT"

  # Restart policy
  restartPolicyType = "ON_FAILURE"
  restartPolicyMaxRetries = 3

# Health check configuration
[deploy.healthCheck]
  path = "/health"
  timeout = 100
  interval = 10
